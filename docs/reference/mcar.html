<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Jamshidian and Jalal's Non-Parametric MCAR Test — mcar • mice</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>


<!-- docsearch -->
<script src="../docsearch.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.3/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous" />
<link href="../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script>



<meta property="og:title" content="Jamshidian and Jalal's Non-Parametric MCAR Test — mcar" />
<meta property="og:description" content="Test whether missingness is contingent upon the observed variables,
according to the methodology developed by Jamshidian and Jalal (2010) (see
Details)." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-inverse navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">mice</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">3.14.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/overview.html">Overview</a>
    </li>
    <li>
      <a href="../articles/oldfriends.html">Help for old friends</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/amices/mice/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
      <form class="navbar-form navbar-right hidden-xs hidden-sm" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
        </div>
      </form>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Jamshidian and Jalal's Non-Parametric MCAR Test</h1>
    <small class="dont-index">Source: <a href='https://github.com/amices/mice/blob/master/R/mcar.R'><code>R/mcar.R</code></a></small>
    <div class="hidden name"><code>mcar.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Test whether missingness is contingent upon the observed variables,
according to the methodology developed by Jamshidian and Jalal (2010) (see
Details).</p>
    </div>

    <pre class="usage"><span class='fu'>mcar</span><span class='op'>(</span>
  <span class='va'>x</span>,
  imputed <span class='op'>=</span> <span class='fu'><a href='mice.html'>mice</a></span><span class='op'>(</span><span class='va'>x</span>, method <span class='op'>=</span> <span class='st'>"norm"</span><span class='op'>)</span>,
  min_n <span class='op'>=</span> <span class='fl'>6</span>,
  method <span class='op'>=</span> <span class='st'>"auto"</span>,
  replications <span class='op'>=</span> <span class='fl'>10000</span>,
  use_chisq <span class='op'>=</span> <span class='fl'>30</span>,
  alpha <span class='op'>=</span> <span class='fl'>0.05</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>An object for which a method exists; usually a <code>data.frame</code>.</p></td>
    </tr>
    <tr>
      <th>imputed</th>
      <td><p>Either an object of class <code>mids</code>, as returned by
<code><a href='mice.html'>mice()</a></code>, or a list of <code>data.frame</code>s.</p></td>
    </tr>
    <tr>
      <th>min_n</th>
      <td><p>Atomic numeric, must be greater than 1. When there are missing
data patterns with fewer than <code>min_n</code> cases, all cases with that pattern will
be removed from <code>x</code> and <code>imputed</code>.</p></td>
    </tr>
    <tr>
      <th>method</th>
      <td><p>Atomic character. If it is known (or assumed) that data are
either multivariate normally distributed or not, then use either
<code>method = "hawkins"</code> or <code>method = "nonparametric"</code>, respectively.
The default argument <code>method = "auto"</code> follows the procedure outlined in the
Details section, and in Figure 7 of Jamshidian and Jalal (2010).</p></td>
    </tr>
    <tr>
      <th>replications</th>
      <td><p>Number of replications used to simulate the Neyman
distribution when performing Hawkins' test. As this method is based on random
sampling, use a high number of <code>replications</code> (and optionally,
<code><a href='https://rdrr.io/r/base/Random.html'>set.seed()</a></code>) to minimize Monte Carlo error and ensure reproducibility.</p></td>
    </tr>
    <tr>
      <th>use_chisq</th>
      <td><p>Atomic integer, indicating the minimum number of cases
within a group <em>k</em> that triggers the use of asymptotic Chi-square
distribution instead of the emprical distribution in the Neyman uniformity
test, which is performed as part of Hawkins' test.</p></td>
    </tr>
    <tr>
      <th>alpha</th>
      <td><p>Atomic numeric, indicating the significance level of tests.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>An object of class <code>mcar_object</code>.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Three types of missingness have been distinguished in the literature
(Rubin, 1976):
Missing completely at random (MCAR), which means that missingness is random;
missing at random (MAR), which means that missingness is contingent on the
<em>observed</em>;
and missing not at random (MNAR), which means that missingness is related to
unobserved data.</p>
<p>Jamshidian and Jalal's non-parametric MCAR test assumes that the missing data
are either MCAR or MAR, and tests whether the missingness is independent of
the observed values. If so, the covariance matrices of the imputed data will
be equal accross groups with different patterns of missingness. This test
consists of the following procedure:</p><ol>
<li><p>Data are imputed.</p></li>
<li><p>The imputed data are split into <em>k</em> groups according to the
<em>k</em> missing data patterns in the original data (see
<code><a href='md.pattern.html'>md.pattern()</a></code>).</p></li>
<li><p>Perform Hawkins' test for equality of covariances across the <em>k</em>
groups.</p></li>
<li><p>If the test is <em>not significant</em>, conclude that there is no evidence
against multivariate normality of the data, nor against MCAR.</p></li>
<li><p>If the test <em>is significant</em>, and multivariate normality of the data
can be assumed, then it can be concluded that missingness is MAR.</p></li>
<li><p>If multivariate normality cannot be assumed, then perform the
Anderson-Darling non-parametric test for equality of covariances across the
<em>k</em> groups.</p></li>
<li><p>If the Anderson-Darling test is <em>not significant</em>, this is evidence
against multivariate normality - but no evidence against MCAR.</p></li>
<li><p>If the Anderson-Darling test <em>is significant</em>, this is evidence
it can be concluded that missingness is MAR.</p></li>
</ol>

<p>Note that, despite its name in common parlance, an MCAR test can only
indicate whether missingness is MCAR or MAR. The procedure cannot distinguish
MCAR from MNAR, so a non-significant result does not rule out MNAR.</p>
<p>This is a re-implementation of the function <code>TestMCARNormality</code>, which was
originally published in the R-packgage <code>MissMech</code>, which has been removed
from CRAN. This new implementation is faster, as its backend is written in
C++. It also enhances the functionality of the original:</p><ul>
<li><p>Multiply imputed data can now be used; the median p-value and test
statistic across replications is then reported, as suggested by
Eekhout, Wiel, and Heymans (2017).</p></li>
<li><p>The printing method for an <code>mcar_object</code> gives a warning when at
least one p-value of either test was significant. In this case, it is
recommended to inspect the range of p-values, and consider potential
violations of MCAR.</p></li>
<li><p>A plotting method for an <code>mcar_object</code> is provided.</p></li>
<li><p>A plotting method for the <code>$md.pattern</code> element of an <code>mcar_object</code>
is provided.</p></li>
</ul>

    <h2 class="hasAnchor" id="references"><a class="anchor" href="#references"></a>References</h2>

    <p>Rubin, D. B. (1976). Inference and Missing Data. Biometrika, Vol. 63, No. 3,
pp. 581-592. doi: <a href='https://doi.org/10.2307/2335739'>10.2307/2335739</a></p>
<p>Eekhout, I., M. A. Wiel, &amp; M. W. Heymans (2017). Methods for Significance
Testing of Categorical Covariates in Logistic Regression Models After
Multiple Imputation: Power and Applicability Analysis. BMC Medical Research
Methodology 17 (1): 129.</p>
<p>Jamshidian, M., &amp; Jalal, S. (2010). Tests of homoscedasticity, normality, and
missing completely at random for incomplete multivariate data. Psychometrika,
75(4), 649–674. doi: <a href='https://doi.org/10.1007/s11336-010-9175-3'>10.1007/s11336-010-9175-3</a></p>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Caspar J. Van Lissa</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><span class='r-in'><span class='va'>res</span> <span class='op'>&lt;-</span> <span class='fu'>mcar</span><span class='op'>(</span><span class='va'>nhanes</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  iter imp variable</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   1   5  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   2   5  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   3   5  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   4   5  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   1  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   2  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   3  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   4  bmi  hyp  chl</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>   5   5  bmi  hyp  chl</span>
<span class='r-in'><span class='co'># Examine test results</span></span>
<span class='r-in'><span class='va'>res</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Missing data patterns: 2 used, 3 removed.</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Cases used: 20 </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Hawkins' test: median chi^2 (4) = 2.20373, median p = 0.6983465. Some p-values for Hawkins' test were significant; please inspect their values, e.g., using `plot(x)`</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Anderson-Darling rank test: median T = 0.7527769, median p = 0.4135451. Some p-values for the Anderson-Darling test were significant; please inspect their values, e.g., using `plot(x)`</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> Interpretation of results:</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  Hawkins' test is not significant; there is no evidence to reject the assumptions of multivariate normality and MCAR.</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>  Anderson-Darling test is not significant. There is thus evidence against multivariate normality, but not against MCAR.</span>
<span class='r-in'><span class='co'># Plot p-values across imputed data sets</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Plot md patterns used for the test</span></span>
<span class='r-in'><span class='fu'><a href='https://rdrr.io/r/graphics/plot.default.html'>plot</a></span><span class='op'>(</span><span class='va'>res</span>, type <span class='op'>=</span> <span class='st'>"md.pattern"</span><span class='op'>)</span></span>
<span class='r-in'><span class='co'># Note difference with the raw md.patterns:</span></span>
<span class='r-in'><span class='fu'><a href='md.pattern.html'>md.pattern</a></span><span class='op'>(</span><span class='va'>nhanes</span><span class='op'>)</span></span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>    age hyp bmi chl   </span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 13   1   1   1   1  0</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 3    1   1   1   0  1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1    1   1   0   1  1</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 1    1   0   0   1  2</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span> 7    1   0   0   0  3</span>
<span class='r-out co'><span class='r-pr'>#&gt;</span>      0   8   9  10 27</span>
</pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Stef van Buuren, Karin Groothuis-Oudshoorn.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script>
<script>
  docsearch({
    
    
    apiKey: '491b6c2ead7f15b8c26c513b923dd6a0',
    indexName: 'mice',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>



  </body>
</html>


